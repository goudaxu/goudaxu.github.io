<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>非LVM无损扩展硬盘分区(不推荐) | Gouda’s Blog</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="非LVM无损扩展硬盘分区(不推荐)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="安装公司samba服务器时对磁盘需求量估计不足，原本分的只有100GB，使用一段时间后磁盘就达到了 86%的使用量， 我的情况 将一块硬盘分成了两个区，一个100GB 一个60GB ，只使用了前100GB空间的内容，后面的分区没有挂载，也没有使用。属于比较好处理的情况 我的步骤： 1、umount 掉sdb磁盘 若提示磁盘忙的话请使用fuser 命令将正在使用磁盘的程序kill掉。 fuser -k -x -u -c /dev/hd1 或者fuser -kxuc /home 2、使用 fdisk /dev/sdb 命令调整分区大小 进去后先使用p命令查看磁柱号 ，切记用笔记下来 ~~~ 别说我没有提醒你哦。。 3、删除掉这你需要变化的分区和需要借用的分区（意思就是准备变大的分区及准备变小的分区）然后再使用n命令建立分区，注意开始的磁柱号要和原来的一致，结束的磁柱号可以是你期望的磁柱号。。不知道的就输入你想要的磁盘大小即可 如+150GB 4、建立需要调整的分区（借用的）。 5、使用保存分区表。 6、使用e2fsck -f /dev/sdb1 \ 需要调整的分区 [root@localhost 桌面]# e2fsck -f /dev/sdb1 e2fsck 1.41.12 (17-May-2010) 第一步: 检查inode,块,和大小 第二步: 检查目录结构 第3步: 检查目录连接性 Pass 4: Checking reference counts 第5步: 检查簇概要信息 /dev/sdb1: 5496/6111232 files (1.8% non-contiguous), 18781569/24416784 blocks 7、最后再使用 resize2fs /dev/sdb1 调整分区大小。 [root@BIGDATA 桌面]# resize2fs /dev/sdb1 resize2fs 1.41.12 (17-May-2010) Resizing the filesystem on /dev/sdb1 to 36622167 (4k) blocks. The filesystem on /dev/sdb1 is now 36622167 blocks long. 8、再mount一个磁盘分区，看看是不是变大了呢 。 用resize2fs 扩展linux分区大小 (2014-07-15 09:31:25) 标签： 分类： linux     最近发现备份服务器的分区空间开始告警，需要扩充磁盘空间， 在存储中把卷扩大后， linux 系统中还不能马上识别， 因为没有用linux 的LVM 来管理磁盘， 所以只好用 fdisk 来扩充分区了。 用fdisk 先删除原有分区， 再重建分区， 起始cylinder 绝对不可以改，这样会破坏原分区的数据。 分区建好后， 就可以用e2fsck 先检查一下分区， 再用resize2fs 扩大就可以了。 root@SHZ-VM-001:/# fdisk /dev/sdb WARNING: DOS-compatible mode is deprecated. It’s strongly recommended to ​ switch off the mode (command ‘c’) and change display units to ​ sectors (command ‘u’). Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System /dev/sdb1 1 26108 209712478+ 83 Linux Command (m for help): m Command action a toggle a bootable flag b edit bsd disklabel c toggle the dos compatibility flag d delete a partition l list known partition types m print this menu n add a new partition o create a new empty DOS partition table p print the partition table q quit without saving changes s create a new empty Sun disklabel t change a partition’s system id u change display/entry units v verify the partition table w write table to disk and exit x extra functionality (experts only) Command (m for help): d Selected partition 1 Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System Command (m for help): m Command action a toggle a bootable flag b edit bsd disklabel c toggle the dos compatibility flag d delete a partition l list known partition types m print this menu n add a new partition o create a new empty DOS partition table p print the partition table q quit without saving changes s create a new empty Sun disklabel t change a partition’s system id u change display/entry units v verify the partition table w write table to disk and exit x extra functionality (experts only) Command (m for help): n Command action e extended p primary partition (1-4) p Partition number (1-4): Value out of range. Partition number (1-4): 1 First cylinder (1-39162, default 1): Using default value 1 Last cylinder, +cylinders or +size{K,M,G} (1-39162, default 39162): Using default value 39162 Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System /dev/sdb1 1 39162 314568733+ 83 Linux Command (m for help): w The partition table has been altered! Calling ioctl() to re-read partition table. Syncing disks. root@SHZ-VM-001:/# root@SHZ-VM-001:/# root@SHZ-VM-001:/# root@SHZ-VM-001:/# resize2fs /dev/sdb1 resize2fs 1.41.11 (14-Mar-2010) Please run ‘e2fsck -f /dev/sdb1’ first. root@SHZ-VM-001:/# e2fsck -f /dev/sdb1 e2fsck 1.41.11 (14-Mar-2010) Pass 1: Checking inodes, blocks, and sizes Pass 2: Checking directory structure Pass 3: Checking directory connectivity Pass 4: Checking reference counts Pass 5: Checking group summary information /dev/sdb1: 474754/13107200 files (0.4% non-contiguous), 45135492/52428119 blocks root@SHZ-VM-001:/# resize2fs /dev/sdb1 resize2fs 1.41.11 (14-Mar-2010) Resizing the filesystem on /dev/sdb1 to 78642183 (4k) blocks. The filesystem on /dev/sdb1 is now 78642183 blocks long. root@SHZ-VM-001:/# mount /dev/sdb1 /lv_backup/ root@SHZ-VM-001:/# ls -l /lv_backup/ lost+found/ rsync_backup/ root@SHZ-VM-001:/# ls -l /lv_backup/rsync_backup/ total 24 drwxr-xr-x 6 root root 4096 2014-07-14 15:26 dmz drwxr-xr-x 60 nobody root 4096 2014-07-15 04:00 forge-router drwxr-xr-x 4 nobody root 4096 2014-06-17 11:21 sz01003 drwxr-xr-x 2 nobody root 4096 2014-07-14 15:17 sz01006 drwxr-xr-x 4 nobody root 4096 2014-06-17 22:00 sz01007 drwxr-xr-x 5 nobody root 4096 2014-06-17 12:54 sz01009 root@SHZ-VM-001:/# df -h Filesystem Size Used Avail Use% Mounted on /dev/sda1 76G 15G 58G 21% / none 1001M 172K 1001M 1% /dev none 1005M 0 1005M 0% /dev/shm none 1005M 60K 1005M 1% /var/run none 1005M 0 1005M 0% /var/lock none 1005M 0 1005M 0% /lib/init/rw /dev/sdb1 296G 170G 112G 61% /lv_backup" />
<meta property="og:description" content="安装公司samba服务器时对磁盘需求量估计不足，原本分的只有100GB，使用一段时间后磁盘就达到了 86%的使用量， 我的情况 将一块硬盘分成了两个区，一个100GB 一个60GB ，只使用了前100GB空间的内容，后面的分区没有挂载，也没有使用。属于比较好处理的情况 我的步骤： 1、umount 掉sdb磁盘 若提示磁盘忙的话请使用fuser 命令将正在使用磁盘的程序kill掉。 fuser -k -x -u -c /dev/hd1 或者fuser -kxuc /home 2、使用 fdisk /dev/sdb 命令调整分区大小 进去后先使用p命令查看磁柱号 ，切记用笔记下来 ~~~ 别说我没有提醒你哦。。 3、删除掉这你需要变化的分区和需要借用的分区（意思就是准备变大的分区及准备变小的分区）然后再使用n命令建立分区，注意开始的磁柱号要和原来的一致，结束的磁柱号可以是你期望的磁柱号。。不知道的就输入你想要的磁盘大小即可 如+150GB 4、建立需要调整的分区（借用的）。 5、使用保存分区表。 6、使用e2fsck -f /dev/sdb1 \ 需要调整的分区 [root@localhost 桌面]# e2fsck -f /dev/sdb1 e2fsck 1.41.12 (17-May-2010) 第一步: 检查inode,块,和大小 第二步: 检查目录结构 第3步: 检查目录连接性 Pass 4: Checking reference counts 第5步: 检查簇概要信息 /dev/sdb1: 5496/6111232 files (1.8% non-contiguous), 18781569/24416784 blocks 7、最后再使用 resize2fs /dev/sdb1 调整分区大小。 [root@BIGDATA 桌面]# resize2fs /dev/sdb1 resize2fs 1.41.12 (17-May-2010) Resizing the filesystem on /dev/sdb1 to 36622167 (4k) blocks. The filesystem on /dev/sdb1 is now 36622167 blocks long. 8、再mount一个磁盘分区，看看是不是变大了呢 。 用resize2fs 扩展linux分区大小 (2014-07-15 09:31:25) 标签： 分类： linux     最近发现备份服务器的分区空间开始告警，需要扩充磁盘空间， 在存储中把卷扩大后， linux 系统中还不能马上识别， 因为没有用linux 的LVM 来管理磁盘， 所以只好用 fdisk 来扩充分区了。 用fdisk 先删除原有分区， 再重建分区， 起始cylinder 绝对不可以改，这样会破坏原分区的数据。 分区建好后， 就可以用e2fsck 先检查一下分区， 再用resize2fs 扩大就可以了。 root@SHZ-VM-001:/# fdisk /dev/sdb WARNING: DOS-compatible mode is deprecated. It’s strongly recommended to ​ switch off the mode (command ‘c’) and change display units to ​ sectors (command ‘u’). Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System /dev/sdb1 1 26108 209712478+ 83 Linux Command (m for help): m Command action a toggle a bootable flag b edit bsd disklabel c toggle the dos compatibility flag d delete a partition l list known partition types m print this menu n add a new partition o create a new empty DOS partition table p print the partition table q quit without saving changes s create a new empty Sun disklabel t change a partition’s system id u change display/entry units v verify the partition table w write table to disk and exit x extra functionality (experts only) Command (m for help): d Selected partition 1 Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System Command (m for help): m Command action a toggle a bootable flag b edit bsd disklabel c toggle the dos compatibility flag d delete a partition l list known partition types m print this menu n add a new partition o create a new empty DOS partition table p print the partition table q quit without saving changes s create a new empty Sun disklabel t change a partition’s system id u change display/entry units v verify the partition table w write table to disk and exit x extra functionality (experts only) Command (m for help): n Command action e extended p primary partition (1-4) p Partition number (1-4): Value out of range. Partition number (1-4): 1 First cylinder (1-39162, default 1): Using default value 1 Last cylinder, +cylinders or +size{K,M,G} (1-39162, default 39162): Using default value 39162 Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System /dev/sdb1 1 39162 314568733+ 83 Linux Command (m for help): w The partition table has been altered! Calling ioctl() to re-read partition table. Syncing disks. root@SHZ-VM-001:/# root@SHZ-VM-001:/# root@SHZ-VM-001:/# root@SHZ-VM-001:/# resize2fs /dev/sdb1 resize2fs 1.41.11 (14-Mar-2010) Please run ‘e2fsck -f /dev/sdb1’ first. root@SHZ-VM-001:/# e2fsck -f /dev/sdb1 e2fsck 1.41.11 (14-Mar-2010) Pass 1: Checking inodes, blocks, and sizes Pass 2: Checking directory structure Pass 3: Checking directory connectivity Pass 4: Checking reference counts Pass 5: Checking group summary information /dev/sdb1: 474754/13107200 files (0.4% non-contiguous), 45135492/52428119 blocks root@SHZ-VM-001:/# resize2fs /dev/sdb1 resize2fs 1.41.11 (14-Mar-2010) Resizing the filesystem on /dev/sdb1 to 78642183 (4k) blocks. The filesystem on /dev/sdb1 is now 78642183 blocks long. root@SHZ-VM-001:/# mount /dev/sdb1 /lv_backup/ root@SHZ-VM-001:/# ls -l /lv_backup/ lost+found/ rsync_backup/ root@SHZ-VM-001:/# ls -l /lv_backup/rsync_backup/ total 24 drwxr-xr-x 6 root root 4096 2014-07-14 15:26 dmz drwxr-xr-x 60 nobody root 4096 2014-07-15 04:00 forge-router drwxr-xr-x 4 nobody root 4096 2014-06-17 11:21 sz01003 drwxr-xr-x 2 nobody root 4096 2014-07-14 15:17 sz01006 drwxr-xr-x 4 nobody root 4096 2014-06-17 22:00 sz01007 drwxr-xr-x 5 nobody root 4096 2014-06-17 12:54 sz01009 root@SHZ-VM-001:/# df -h Filesystem Size Used Avail Use% Mounted on /dev/sda1 76G 15G 58G 21% / none 1001M 172K 1001M 1% /dev none 1005M 0 1005M 0% /dev/shm none 1005M 60K 1005M 1% /var/run none 1005M 0 1005M 0% /var/lock none 1005M 0 1005M 0% /lib/init/rw /dev/sdb1 296G 170G 112G 61% /lv_backup" />
<link rel="canonical" href="http://0.0.0.0:4000/linux/2021/12/04/%E9%9D%9ELVM%E6%97%A0%E6%8D%9F%E6%89%A9%E5%B1%95%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA.html" />
<meta property="og:url" content="http://0.0.0.0:4000/linux/2021/12/04/%E9%9D%9ELVM%E6%97%A0%E6%8D%9F%E6%89%A9%E5%B1%95%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA.html" />
<meta property="og:site_name" content="Gouda’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-04T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="非LVM无损扩展硬盘分区(不推荐)" />
<script type="application/ld+json">
{"description":"安装公司samba服务器时对磁盘需求量估计不足，原本分的只有100GB，使用一段时间后磁盘就达到了 86%的使用量， 我的情况 将一块硬盘分成了两个区，一个100GB 一个60GB ，只使用了前100GB空间的内容，后面的分区没有挂载，也没有使用。属于比较好处理的情况 我的步骤： 1、umount 掉sdb磁盘 若提示磁盘忙的话请使用fuser 命令将正在使用磁盘的程序kill掉。 fuser -k -x -u -c /dev/hd1 或者fuser -kxuc /home 2、使用 fdisk /dev/sdb 命令调整分区大小 进去后先使用p命令查看磁柱号 ，切记用笔记下来 ~~~ 别说我没有提醒你哦。。 3、删除掉这你需要变化的分区和需要借用的分区（意思就是准备变大的分区及准备变小的分区）然后再使用n命令建立分区，注意开始的磁柱号要和原来的一致，结束的磁柱号可以是你期望的磁柱号。。不知道的就输入你想要的磁盘大小即可 如+150GB 4、建立需要调整的分区（借用的）。 5、使用保存分区表。 6、使用e2fsck -f /dev/sdb1 \\ 需要调整的分区 [root@localhost 桌面]# e2fsck -f /dev/sdb1 e2fsck 1.41.12 (17-May-2010) 第一步: 检查inode,块,和大小 第二步: 检查目录结构 第3步: 检查目录连接性 Pass 4: Checking reference counts 第5步: 检查簇概要信息 /dev/sdb1: 5496/6111232 files (1.8% non-contiguous), 18781569/24416784 blocks 7、最后再使用 resize2fs /dev/sdb1 调整分区大小。 [root@BIGDATA 桌面]# resize2fs /dev/sdb1 resize2fs 1.41.12 (17-May-2010) Resizing the filesystem on /dev/sdb1 to 36622167 (4k) blocks. The filesystem on /dev/sdb1 is now 36622167 blocks long. 8、再mount一个磁盘分区，看看是不是变大了呢 。 用resize2fs 扩展linux分区大小 (2014-07-15 09:31:25) 标签： 分类： linux     最近发现备份服务器的分区空间开始告警，需要扩充磁盘空间， 在存储中把卷扩大后， linux 系统中还不能马上识别， 因为没有用linux 的LVM 来管理磁盘， 所以只好用 fdisk 来扩充分区了。 用fdisk 先删除原有分区， 再重建分区， 起始cylinder 绝对不可以改，这样会破坏原分区的数据。 分区建好后， 就可以用e2fsck 先检查一下分区， 再用resize2fs 扩大就可以了。 root@SHZ-VM-001:/# fdisk /dev/sdb WARNING: DOS-compatible mode is deprecated. It’s strongly recommended to ​ switch off the mode (command ‘c’) and change display units to ​ sectors (command ‘u’). Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System /dev/sdb1 1 26108 209712478+ 83 Linux Command (m for help): m Command action a toggle a bootable flag b edit bsd disklabel c toggle the dos compatibility flag d delete a partition l list known partition types m print this menu n add a new partition o create a new empty DOS partition table p print the partition table q quit without saving changes s create a new empty Sun disklabel t change a partition’s system id u change display/entry units v verify the partition table w write table to disk and exit x extra functionality (experts only) Command (m for help): d Selected partition 1 Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System Command (m for help): m Command action a toggle a bootable flag b edit bsd disklabel c toggle the dos compatibility flag d delete a partition l list known partition types m print this menu n add a new partition o create a new empty DOS partition table p print the partition table q quit without saving changes s create a new empty Sun disklabel t change a partition’s system id u change display/entry units v verify the partition table w write table to disk and exit x extra functionality (experts only) Command (m for help): n Command action e extended p primary partition (1-4) p Partition number (1-4): Value out of range. Partition number (1-4): 1 First cylinder (1-39162, default 1): Using default value 1 Last cylinder, +cylinders or +size{K,M,G} (1-39162, default 39162): Using default value 39162 Command (m for help): p Disk /dev/sdb: 322.1 GB, 322122547200 bytes 255 heads, 63 sectors/track, 39162 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x76148198 Device Boot Start End Blocks Id System /dev/sdb1 1 39162 314568733+ 83 Linux Command (m for help): w The partition table has been altered! Calling ioctl() to re-read partition table. Syncing disks. root@SHZ-VM-001:/# root@SHZ-VM-001:/# root@SHZ-VM-001:/# root@SHZ-VM-001:/# resize2fs /dev/sdb1 resize2fs 1.41.11 (14-Mar-2010) Please run ‘e2fsck -f /dev/sdb1’ first. root@SHZ-VM-001:/# e2fsck -f /dev/sdb1 e2fsck 1.41.11 (14-Mar-2010) Pass 1: Checking inodes, blocks, and sizes Pass 2: Checking directory structure Pass 3: Checking directory connectivity Pass 4: Checking reference counts Pass 5: Checking group summary information /dev/sdb1: 474754/13107200 files (0.4% non-contiguous), 45135492/52428119 blocks root@SHZ-VM-001:/# resize2fs /dev/sdb1 resize2fs 1.41.11 (14-Mar-2010) Resizing the filesystem on /dev/sdb1 to 78642183 (4k) blocks. The filesystem on /dev/sdb1 is now 78642183 blocks long. root@SHZ-VM-001:/# mount /dev/sdb1 /lv_backup/ root@SHZ-VM-001:/# ls -l /lv_backup/ lost+found/ rsync_backup/ root@SHZ-VM-001:/# ls -l /lv_backup/rsync_backup/ total 24 drwxr-xr-x 6 root root 4096 2014-07-14 15:26 dmz drwxr-xr-x 60 nobody root 4096 2014-07-15 04:00 forge-router drwxr-xr-x 4 nobody root 4096 2014-06-17 11:21 sz01003 drwxr-xr-x 2 nobody root 4096 2014-07-14 15:17 sz01006 drwxr-xr-x 4 nobody root 4096 2014-06-17 22:00 sz01007 drwxr-xr-x 5 nobody root 4096 2014-06-17 12:54 sz01009 root@SHZ-VM-001:/# df -h Filesystem Size Used Avail Use% Mounted on /dev/sda1 76G 15G 58G 21% / none 1001M 172K 1001M 1% /dev none 1005M 0 1005M 0% /dev/shm none 1005M 60K 1005M 1% /var/run none 1005M 0 1005M 0% /var/lock none 1005M 0 1005M 0% /lib/init/rw /dev/sdb1 296G 170G 112G 61% /lv_backup","url":"http://0.0.0.0:4000/linux/2021/12/04/%E9%9D%9ELVM%E6%97%A0%E6%8D%9F%E6%89%A9%E5%B1%95%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA.html","@type":"BlogPosting","headline":"非LVM无损扩展硬盘分区(不推荐)","dateModified":"2021-12-04T00:00:00+08:00","datePublished":"2021-12-04T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/linux/2021/12/04/%E9%9D%9ELVM%E6%97%A0%E6%8D%9F%E6%89%A9%E5%B1%95%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Gouda's Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Gouda&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">非LVM无损扩展硬盘分区(不推荐)</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-12-04T00:00:00+08:00" itemprop="datePublished">Dec 4, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>安装公司samba服务器时对磁盘需求量估计不足，原本分的只有100GB，使用一段时间后磁盘就达到了 86%的使用量，<img src="http://b.bst.126.net/common/portrait/face/preview/face15.gif" alt="使用resize2fs调整ext4分区大小 - 明天的阳光 - 明天的阳光" /></p>

<p>我的情况  将一块硬盘分成了两个区，一个100GB 一个60GB  ，只使用了前100GB空间的内容，后面的分区没有挂载，也没有使用。属于比较好处理的情况</p>

<p>我的步骤：</p>

<p>1、umount 掉sdb磁盘    若提示磁盘忙的话请使用fuser  命令将正在使用磁盘的程序kill掉。</p>

<p>fuser -k -x -u -c /dev/hd1 或者fuser -kxuc /home</p>

<p>2、使用 fdisk  /dev/sdb 命令调整分区大小   进去后先使用p命令查看磁柱号 ，切记用笔记下来 ~~~ 别说我没有提醒你哦。。</p>

<p>3、删除掉这你需要变化的分区和需要借用的分区（意思就是准备变大的分区及准备变小的分区）然后再使用n命令建立分区，注意开始的磁柱号要和原来的一致，结束的磁柱号可以是你期望的磁柱号。。不知道的就输入你想要的磁盘大小即可 如+150GB</p>

<p>4、建立需要调整的分区（借用的）。</p>

<p>5、使用保存分区表。</p>

<p>6、使用e2fsck  -f    /dev/sdb1     \ 需要调整的分区</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p>[root@localhost 桌面]# e2fsck -f /dev/sdb1 e2fsck 1.41.12 (17-May-2010) 第一步: 检查inode,块,和大小 第二步: 检查目录结构 第3步: 检查目录连接性 Pass 4: Checking reference counts 第5步: 检查簇概要信息 /dev/sdb1: 5496/6111232 files (1.8% non-contiguous), 18781569/24416784 blocks</p>

<p>7、最后再使用 resize2fs /dev/sdb1 调整分区大小。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p>[root@BIGDATA 桌面]# resize2fs /dev/sdb1 resize2fs 1.41.12 (17-May-2010) Resizing the filesystem on /dev/sdb1 to 36622167 (4k) blocks. The filesystem on /dev/sdb1 is now 36622167 blocks long.</p>

<p>8、再mount一个磁盘分区，看看是不是变大了呢 。</p>

<h2 id="用resize2fs-扩展linux分区大小">用resize2fs 扩展linux分区大小</h2>

<p>(2014-07-15 09:31:25)</p>

<table>
  <thead>
    <tr>
      <th>标签：</th>
      <th>分类： <a href="http://blog.sina.com.cn/s/articlelist_2099389457_6_1.html">linux</a></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>最近发现备份服务器的分区空间开始告警，需要扩充磁盘空间， 在存储中把卷扩大后， linux 系统中还不能马上识别， 因为没有用linux 的LVM 来管理磁盘， 所以只好用 fdisk 来扩充分区了。</p>

<p>用fdisk 先删除原有分区， 再重建分区， 起始cylinder 绝对不可以改，这样会破坏原分区的数据。</p>

<p>分区建好后， 就可以用e2fsck 先检查一下分区， 再用resize2fs 扩大就可以了。</p>

<p>root@SHZ-VM-001:/# fdisk /dev/sdb</p>

<p>WARNING: DOS-compatible mode is deprecated. It’s strongly recommended to</p>

<p>​        switch off the mode (command ‘c’) and change display units to</p>

<p>​        sectors (command ‘u’).</p>

<p>Command (m for help): p</p>

<p>Disk /dev/sdb: 322.1 GB, 322122547200 bytes</p>

<p>255 heads, 63 sectors/track, 39162 cylinders</p>

<p>Units = cylinders of 16065 * 512 = 8225280 bytes</p>

<p>Sector size (logical/physical): 512 bytes / 512 bytes</p>

<p>I/O size (minimum/optimal): 512 bytes / 512 bytes</p>

<p>Disk identifier: 0x76148198</p>

<p>Device Boot      Start        End     Blocks   Id  System</p>

<p>/dev/sdb1             1      26108  209712478+  83  Linux</p>

<p>Command (m for help): m</p>

<p>Command action</p>

<p>a  toggle a bootable flag</p>

<p>b   edit bsd disklabel</p>

<p>c  toggle the dos compatibility flag</p>

<p>d  delete a partition</p>

<p>l   list known partition types</p>

<p>m  print this menu</p>

<p>n   add a new partition</p>

<p>o  create a new empty DOS partition table</p>

<p>p  print the partition table</p>

<p>q   quit without saving changes</p>

<p>s  create a new empty Sun disklabel</p>

<p>t  change a partition’s system id</p>

<p>u  change display/entry units</p>

<p>v  verify the partition table</p>

<p>w  write table to disk and exit</p>

<p>x  extra functionality (experts only)</p>

<p>Command (m for help): d</p>

<p>Selected partition 1</p>

<p>Command (m for help): p</p>

<p>Disk /dev/sdb: 322.1 GB, 322122547200 bytes</p>

<p>255 heads, 63 sectors/track, 39162 cylinders</p>

<p>Units = cylinders of 16065 * 512 = 8225280 bytes</p>

<p>Sector size (logical/physical): 512 bytes / 512 bytes</p>

<p>I/O size (minimum/optimal): 512 bytes / 512 bytes</p>

<p>Disk identifier: 0x76148198</p>

<p>Device Boot      Start        End     Blocks   Id  System</p>

<p>Command (m for help): m</p>

<p>Command action</p>

<p>a  toggle a bootable flag</p>

<p>b   edit bsd disklabel</p>

<p>c  toggle the dos compatibility flag</p>

<p>d  delete a partition</p>

<p>l   list known partition types</p>

<p>m  print this menu</p>

<p>n   add a new partition</p>

<p>o  create a new empty DOS partition table</p>

<p>p  print the partition table</p>

<p>q   quit without saving changes</p>

<p>s  create a new empty Sun disklabel</p>

<p>t  change a partition’s system id</p>

<p>u  change display/entry units</p>

<p>v  verify the partition table</p>

<p>w  write table to disk and exit</p>

<p>x  extra functionality (experts only)</p>

<p>Command (m for help): n</p>

<p>Command action</p>

<p>e  extended</p>

<p>p  primary partition (1-4)</p>

<p>p</p>

<p>Partition number (1-4):</p>

<p>Value out of range.</p>

<p>Partition number (1-4): 1</p>

<p>First cylinder (1-39162, default 1):</p>

<p>Using default value 1</p>

<p>Last cylinder, +cylinders or +size{K,M,G} (1-39162, default 39162):</p>

<p>Using default value 39162</p>

<p>Command (m for help): p</p>

<p>Disk /dev/sdb: 322.1 GB, 322122547200 bytes</p>

<p>255 heads, 63 sectors/track, 39162 cylinders</p>

<p>Units = cylinders of 16065 * 512 = 8225280 bytes</p>

<p>Sector size (logical/physical): 512 bytes / 512 bytes</p>

<p>I/O size (minimum/optimal): 512 bytes / 512 bytes</p>

<p>Disk identifier: 0x76148198</p>

<p>Device Boot      Start        End     Blocks   Id  System</p>

<p>/dev/sdb1             1      39162  314568733+  83  Linux</p>

<p>Command (m for help): w</p>

<p>The partition table has been altered!</p>

<p>Calling ioctl() to re-read partition table.</p>

<p>Syncing disks.</p>

<p>root@SHZ-VM-001:/#</p>

<p>root@SHZ-VM-001:/#</p>

<p>root@SHZ-VM-001:/#</p>

<p>root@SHZ-VM-001:/# resize2fs /dev/sdb1</p>

<p>resize2fs 1.41.11 (14-Mar-2010)</p>

<p>Please run ‘e2fsck -f /dev/sdb1’ first.</p>

<p>root@SHZ-VM-001:/# e2fsck -f /dev/sdb1</p>

<p>e2fsck 1.41.11 (14-Mar-2010)</p>

<p>Pass 1: Checking inodes, blocks, and sizes</p>

<p>Pass 2: Checking directory structure</p>

<p>Pass 3: Checking directory connectivity</p>

<p>Pass 4: Checking reference counts</p>

<p>Pass 5: Checking group summary information</p>

<p>/dev/sdb1: 474754/13107200 files (0.4% non-contiguous), 45135492/52428119 blocks</p>

<p>root@SHZ-VM-001:/# resize2fs /dev/sdb1</p>

<p>resize2fs 1.41.11 (14-Mar-2010)</p>

<p>Resizing the filesystem on /dev/sdb1 to 78642183 (4k) blocks.</p>

<p>The filesystem on /dev/sdb1 is now 78642183 blocks long.</p>

<p>root@SHZ-VM-001:/# mount /dev/sdb1 /lv_backup/</p>

<p>root@SHZ-VM-001:/# ls -l /lv_backup/</p>

<p>lost+found/   rsync_backup/</p>

<p>root@SHZ-VM-001:/# ls -l /lv_backup/rsync_backup/</p>

<p>total 24</p>

<p>drwxr-xr-x  6 root   root 4096 2014-07-14 15:26 dmz</p>

<p>drwxr-xr-x 60 nobody root 4096 2014-07-15 04:00 forge-router</p>

<p>drwxr-xr-x  4 nobody root 4096 2014-06-17 11:21 sz01003</p>

<p>drwxr-xr-x  2 nobody root 4096 2014-07-14 15:17 sz01006</p>

<p>drwxr-xr-x  4 nobody root 4096 2014-06-17 22:00 sz01007</p>

<p>drwxr-xr-x  5 nobody root 4096 2014-06-17 12:54 sz01009</p>

<p>root@SHZ-VM-001:/# df -h</p>

<p>Filesystem          Size  Used Avail Use% Mounted on</p>

<p>/dev/sda1            76G   15G   58G  21% /</p>

<p>none               1001M  172K 1001M   1% /dev</p>

<p>none               1005M    0 1005M   0% /dev/shm</p>

<p>none               1005M   60K 1005M   1% /var/run</p>

<p>none               1005M    0 1005M   0% /var/lock</p>

<p>none               1005M    0 1005M   0% /lib/init/rw</p>

<p>/dev/sdb1           296G  170G  112G  61% /lv_backup</p>


  </div><a class="u-url" href="/linux/2021/12/04/%E9%9D%9ELVM%E6%97%A0%E6%8D%9F%E6%89%A9%E5%B1%95%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Gouda&#39;s Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Gouda&#39;s Blog</li><li><a class="u-email" href="mailto:nightwindxu@gmail.com">nightwindxu@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/goudaxu"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">goudaxu</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
