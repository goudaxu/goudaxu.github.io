<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta content="#ffffff" name="theme-color" />
  <meta content="#da532c" name="msapplication-TileColor" />

  
  <link href='&#x2F;icons&#x2F;site.webmanifest' rel="manifest" />
  
  
  <link color="#5bbad5" href='&#x2F;icons&#x2F;safari-pinned-tab.svg' rel="mask-icon" />
  
  
  <link href='&#x2F;icons&#x2F;favicon-16x16.png' rel="icon" sizes="16x16" type="image/png" />
  
  
  <link href='&#x2F;icons&#x2F;favicon-32x32.png' rel="icon" sizes="32x32" type="image/png" />
  
  
  <link href='&#x2F;icons&#x2F;apple-touch-icon.png' rel="apple-touch-icon" sizes="180x180" />
  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/themes/folio/galleria.folio.min.css" integrity="sha384-+rY0QD+LRnTOquDMzGa9lXU6jIwdiQuwCJQ2cdcW0qeP/0UbjQCZlXnRsUMA+9pH" crossorigin="anonymous">
  

  

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.1/css/academicons.min.css" integrity="sha384-FIue+PI4SsI9XfHCz8dBLg33b0c1fMJgNU3X//L26FYbGnlSEfWmNT7zgWc2N9b6" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css" integrity="sha384-IJLmUY0f1ePPX6uSCJ9Bxik64/meJmjSYD7dHaJqTXXEBE4y+Oe9P2KBZa/z7p0Q" crossorigin="anonymous">
  <link href="https://www.xuhaoda.com/deep-thought.css" rel="stylesheet" />
  
  

  <title>
    
Gouda&#x27;s Blog | shell中!感叹号的妙用

  </title>

  
  
  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx" crossorigin="anonymous"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mathtex-script-type.min.js" integrity="sha384-jiBVvJ8NGGj5n7kJaiWwWp9AjC+Yh8rhZY3GtAX8yU28azcLgoRo4oukO87g7zDT" crossorigin="anonymous"></script>
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
  
  
</head>

<body class="has-background-white">
  <nav aria-label="section navigation" class="navbar is-light" role="navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item is-size-5 has-text-weight-bold" href="https:&#x2F;&#x2F;www.xuhaoda.com">Gouda&#x27;s Blog</a>
        <a aria-expanded="false" aria-label="menu" class="navbar-burger burger" data-target="navMenu" role="button">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu" id="navMenu">
        <div class="navbar-end has-text-centered">
          
          
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;www.xuhaoda.com&#x2F;">
            主页
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;www.xuhaoda.com&#x2F;linux">
            Linux
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;www.xuhaoda.com&#x2F;ruby">
            Ruby
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;www.xuhaoda.com&#x2F;tags">
            标签
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;www.xuhaoda.com&#x2F;categories">
            分类
          </a>
          
          
          
          
          
          <a class="navbar-item" id="nav-search" title="Search" data-target="#search-modal">
            <span class="icon">
              <i class="fas fa-search"></i>
            </span>
          </a>
          <a class="navbar-item" id="dark-mode" title="Switch to dark theme">
            <span class="icon">
              <i class="fas fa-adjust"></i>
            </span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  
  

  
<section class="section">
  <div class="container">
    <div class="columns">
      <div class="column is-8 is-offset-2">
        <article class="box">
          <h1 class="title">
            shell中!感叹号的妙用
          </h1>
          <p class="subtitle"></p>
          <div class="columns is-multiline is-gapless">
            <div class="column is-8">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="fas fa-user"></i>
  </span>
  <span>Gouda published on</span>
  <span class="icon">
    <i class="far fa-calendar-alt"></i>
  </span>
  <span><time datetime="2021-12-04">December 04, 2021</time></span>
</span>

            </div>
            <div class="column is-4 has-text-right-desktop">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="far fa-clock"></i>
  </span>
  <span>6 min,</span>
  <span class="icon">
    <i class="fas fa-pencil-alt"></i>
  </span>
  <span>1112 words</span>
</span>

            </div>
            <div class="column">
              
              
<p>
  Categories:
  
  <a class="has-text-info-dark has-text-weight-semibold" href="https://www.xuhaoda.com/categories/mac/">
    <span class="icon-text">
      <span class="icon">
        <i class="fas fa-cube"></i>
      </span>
      <span>mac</span>
    </span>
  </a>
  
  <a class="has-text-info-dark has-text-weight-semibold" href="https://www.xuhaoda.com/categories/linux/">
    <span class="icon-text">
      <span class="icon">
        <i class="fas fa-cube"></i>
      </span>
      <span>linux</span>
    </span>
  </a>
  
</p>

              
            </div>
            <div class="column has-text-right-desktop">
              
              
<p>
  Tags:
  
  <a class="has-text-info-dark has-text-weight-semibold" href="https://www.xuhaoda.com/tags/shell/">
    <span class="icon-text">
      <span class="icon">
        <i class="fas fa-tag"></i>
      </span>
      <span>shell</span>
    </span>
  </a>
  
  <a class="has-text-info-dark has-text-weight-semibold" href="https://www.xuhaoda.com/tags/gan-tan-hao/">
    <span class="icon-text">
      <span class="icon">
        <i class="fas fa-tag"></i>
      </span>
      <span>感叹号</span>
    </span>
  </a>
  
  <a class="has-text-info-dark has-text-weight-semibold" href="https://www.xuhaoda.com/tags//">
    <span class="icon-text">
      <span class="icon">
        <i class="fas fa-tag"></i>
      </span>
      <span>!</span>
    </span>
  </a>
  
</p>

              
            </div>
          </div>
          <div class="content mt-2">
            <p>整天在shell环境下操作，不积累点快捷输入的小技巧是不行的。</p>
<p>最常用的技巧恐怕就是Tab自动补全以及上方向键来回退上几条历史命令了，这些对于csh，bash，ksh，zsh都适用。</p>
<p>! 符号在 Linux 中不但可以用作否定符号，还可以用来从历史命令记录中取出命令或不加修改的执行之前运行的命令。下面的所有命令都已经在 Bash Shell 中经过确切地检验。尽管我没有试过，但大多都不能在别的 Shell 中运行。这里我们介绍下 Linux 命令行中符号 ! 那惊人和奇妙的用法。</p>
<p><strong>执行上一条命令</strong></p>
<p>例如，在执行完上面一条命令后，可以使用下面的方式再次执行上一条命令：</p>
<p>$ whereis bash #执行命令</p>
<p>bash: /bin/bash /etc/bash.bashrc</p>
<p>$ !! #再次执行上一条命令</p>
<p>whereis bash</p>
<p>bash: /bin/bash /etc/bash.bashrc</p>
<p>!!代表了上一条执行的命令。可以看到，当输入两个感叹号时，它显示上条命令的同时会执行上一条命令。当然了，通常我们还会想到使用“UP”键来完成这个事情。但是如果是基于上条命令扩充，!!就来得更加方便了。</p>
<p>比如，你想查看某个文件，但是忘了输入more：</p>
<p>$ /opt/user/test.txt #忘记输入more</p>
<p>$ more !! #这样是不是快多了？</p>
<p>使用!!是不是方便多了？</p>
<p><strong>使用上个命令第一个或最后一个的参数执行命令</strong></p>
<p><strong>使用上条命令最后一个参数</strong></p>
<p>比如，你在使用ls列出目录内容时，没有带任何参数，但是想再次执行，带上-al参数，又不想输入长长的参数，可以使用下面的方式：</p>
<p>$ ls /etc/udev</p>
<p>/etc/udev</p>
<p>$ ls -al !$</p>
<p>ls -al /etc/udev</p>
<p>-r--r--r-- 1 root root 0 Jan 20 09:30 /etc/udev</p>
<p>这里的!$代表了上一条命令的最后一个参数。</p>
<p><strong>使用上条命令第一个参数</strong></p>
<p>而使用上条命令的第一个参数只需要使用!^，例如：</p>
<p>$ ls -al !^</p>
<p>去掉最后一个参数执行上一个命令</p>
<p>如果想执行上条命令，但不想带上最后一个参数：</p>
<p>$ ls -al dir #假设dir是一个很长的字符串</p>
<p>$ !:-</p>
<p>ls -al</p>
<p>什么场景下可能会用呢？比如你上一条命令最后一个参数是一个长长的字符串，而你恰好不想不用它，并且退格键删除又慢的时候，可以使用上面的方法。</p>
<p><strong>使用上条命令的所有参数</strong></p>
<p>前面说了使用上条命令的最后一个参数，那如果不是最后一个参数，该如何使用呢？很简单，使用!*即可。例如我们在输入find命令输错了，想要纠正的时候：</p>
<p>$ finsd -name &quot;foo.zip&quot; # 这里特意输错了find命令</p>
<p>$ find !*</p>
<p>find ./ -name &quot;foo.zip&quot;</p>
<p>./bar/foo.zip</p>
<p>./data/py/foo.zip</p>
<p><strong>使用上条命令指定的参数</strong></p>
<p>有的读者可能会问了，如果我只想用其中某个参数呢？按照![命令名]:[参数号]的规则即可。例如：</p>
<p>$ cp -rf dira dirb/ #将dira拷贝到dirb</p>
<p>$ ls -l !cp:2 #查看dira的内容</p>
<p>ls -l dira</p>
<p>total 0</p>
<p>-rw-rw-r-- 1 hyb hyb 0 Jan 20 16:18 barfile</p>
<p>当上条命令的参数很长，而你需要取用中间的某个参数时，效果就比较明显了。</p>
<p><strong>执行上一条以关键字开头的命令</strong></p>
<p>例如，执行上一条find命令：</p>
<p>$ !find #执行上条以find开头的命令</p>
<p><strong>逻辑非的作用</strong></p>
<p>这个是它最为人所熟悉的作用，例如删除除了cfg结尾以外的所有文件：</p>
<p>rm !(*.cfg)</p>
<p><strong>小结</strong></p>
<p>惊叹号的其他惊叹功能一览：</p>
<p>!!</p>
<p>上一条命令</p>
<p>!$</p>
<p>上一条命令中的最后一个参数</p>
<p>!:-</p>
<p>上一命令除了最后一个参数</p>
<p>!*</p>
<p>上一条命令中的所有参数</p>
<p>!str</p>
<p>最近一条以str开头的命令</p>
<p>!?str?</p>
<p>最近一条包含str的命令</p>
<p>!n</p>
<p>顺数第n条命令</p>
<p>!-n</p>
<p>倒数第n条命令</p>
<p>^old^new</p>
<p>将上一命令中的old替换为new</p>
<p>!!:gs/old/new</p>
<p>将上一命令中的old替换为new</p>
<p>!scp:gs/old/new</p>
<p>将上一scp命令中的old替换为new</p>
<p><strong>逻辑非的作用</strong></p>
<p>这个是它最为人所熟悉的作用，例如删除除了cfg结尾以外的所有文件：</p>
<pre style="background-color:#2b303b;color:#6c7079;"><code><span style="color:#abb2bf;">rm !(*.cfg)  #删除需谨慎</span><span style="color:#abb2bf;">
</span></code></pre>

          </div>
        </article>
      </div>
      
    </div>
  </div>
</section>


  
  <section class="modal" id="search-modal">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <p class="modal-card-title">Search</p>
      </header>
      <section class="modal-card-body">
        <div class="field mb-2">
          <div class="control">
            <input class="input" id="search" placeholder="Search this website." type="search" />
          </div>
        </div>
        <div class="search-results">
          <div class="search-results__items"></div>
        </div>
      </section>
    </div>
    <button aria-label="close" class="modal-close is-large"></button>
  </section>
  


  

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <nav class="level">
          
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;www.xuhaoda.com&#x2F;linux&#x2F;mac-osjin-yong-lin-shi-ipv6&#x2F;">
              <span class="icon mr-2">
                <i class="fas fa-arrow-circle-left"></i>
              </span>
              MACOS临时禁用IPv6
            </a>
          </div>
           
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;www.xuhaoda.com&#x2F;linux&#x2F;ubuntutian-jia-cheng-xu-dao-zhuo-mian&#x2F;">
              Ubuntu添加程序到桌面<span class="icon ml-2">
                <i class="fas fa-arrow-circle-right"></i>
              </span>
            </a>
          </div>
            
        </nav>
      </div>
    </div>
  </div>
</section>



  



  <footer class="footer py-4">
    <div class="content has-text-centered">
      <p>
        Built with
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-code"></i>
          </span>
          <span>code</span>
        </span>
        and
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-heart"></i>
          </span>
          <span>love</span>
        </span>
      </p>
      <p>
        Powered by
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-power-off"></i>
          </span>
          <span>zola</span>
        </span>
      </p>
    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/galleria.min.js" integrity="sha384-QSfwGT8/EU536DKdtyP2D6SLlh8zBaZ0cVkwfrwhqzIU9VCfJT00CLVP5t+HAiYg" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/themes/folio/galleria.folio.min.js" integrity="sha384-DwpKI+deZB267+hPKwiOIc5Y2GKsVL0mR6hgz7GgIu7AgAMYqJwcJKY1YBNfhWcY" crossorigin="anonymous"></script>
  
  
  <script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.5/dist/mermaid.min.js" integrity="sha384-0yWn54pSGtfKCU+skfA69l25VsCw+MZt4LQov3xNRoS7YkAMrFokGgSBnAWSK4pv" crossorigin="anonymous"></script>
  
  
  <script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1.1.13/dist/chart.xkcd.min.js" integrity="sha384-xC3h1+IHXK8seA+8KfT79Z4e0GPsznjXBoMa5nd8ooWKplPyXx92NOmljWxLC/cs" crossorigin="anonymous"></script>
  
  
  <script src="https://www.xuhaoda.com/elasticlunr.min.js"></script>
  <script src="https://www.xuhaoda.com/search_index.en.js"></script><script src="https://www.xuhaoda.com/js/site.js"></script>

  





  
  
</body>

</html>
